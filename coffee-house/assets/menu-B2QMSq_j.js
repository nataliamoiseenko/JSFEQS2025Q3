import{i as H,f as N,E as O,S as C}from"./api-D0DhSArP.js";import{M}from"./products-DO6KCWU1.js";const h=H(),T=[];let E=[],L=[],f=null,m=[];const R=document.getElementById("menu-content"),x=document.getElementsByClassName("menu__grid")[0],g=document.querySelectorAll('input[name="menu-tab-btn"]'),v=document.getElementById("refresh-btn"),q=document.getElementById("carousel-loading"),F=document.getElementById("carousel-error"),_=document.getElementById("modal"),U=document.getElementById("modal-bg"),b=document.getElementById("modal-content"),w=document.getElementById("modal-loader"),$=document.getElementById("modal-img"),J=document.getElementById("modal-title"),K=document.getElementById("modal-desc"),I=document.getElementById("modal-sizes"),S=document.getElementById("modal-adds"),j=document.getElementById("modal-price"),G=document.getElementById("modal-close"),z=document.getElementById("modal-error"),A=document.getElementById("add-to-cart"),W=document.getElementById("cart-icon"),P=document.getElementById("cart-sum"),Q=e=>{const d=document.createElement("img");d.classList.add("menu__img"),d.src=e.imgSrc,d.alt=`${e.name} image`;const t=document.createElement("div");t.classList.add("menu__img-container"),t.appendChild(d);const i=document.createElement("h3");i.classList.add("menu__preview-item-heading","heading-3"),i.innerText=e.name;const n=document.createElement("p");n.classList.add("menu__preview-item-subtitle","body-medium"),n.innerText=e.description;const r=document.createElement("div");r.classList.add("menu__preview-item-prices");const l=document.createElement("h3");if(l.classList.add("menu__preview-item-price","heading-3"),l.innerText=`$${h?e.discountPrice:e.price}`,r.appendChild(l),h){const a=document.createElement("h3");a.classList.add("menu__preview-item-price-sec","heading-3"),a.innerText=`$${e.price}`,r.appendChild(a)}const s=document.createElement("div");s.classList.add("menu__preview-item-description"),s.appendChild(i),s.appendChild(n),s.appendChild(r);const o=document.createElement("button");o.classList.add("menu__preview-item-link"),o.addEventListener("click",y.bind(null,e,!0)),o.appendChild(t),o.appendChild(s);const c=document.createElement("li");return c.classList.add("menu__preview-item"),c.appendChild(o),c},y=async(e,d=!0)=>{if(d?(document.body.classList.add("no-scroll"),_.classList.add("_active"),w.style.display="flex",z.style.display="none"):(document.body.classList.remove("no-scroll"),_.classList.remove("_active"),b.style.display="none",E.forEach(([t,i])=>{t.removeEventListener("change",i)}),L.forEach(([t,i])=>{t.removeEventListener("click",i)}),E=L=[],f=null,m=[]),e)try{const t=await N(`${O.PRODUCTS}/${e.id}`),i=T.find(({id:l})=>l===e.id);if(!i)throw new Error;const n={...t,imgSrc:i.imgSrc};$.src=n.imgSrc,$.alt=`${n.name} image`,J.innerText=n.name,K.innerText=n.description,I.replaceChildren(),Object.entries(n.sizes).forEach(([l,s],o)=>{const c=document.createElement("label");c.classList.add("modal__option-container","button-link"),c.title=s.size,c.htmlFor=s.size;const a=document.createElement("input");a.type="radio",a.id=s.size,a.name="size",a.value=h?s.discountPrice??s.price:s.price,o===0&&(a.checked=!0);const u=B.bind(null,n);a.addEventListener("change",u),E.push([a,u]);const p=document.createElement("span");p.classList.add("modal__option-label"),p.innerText=`${l}`.toUpperCase();const k=document.createElement("span");k.innerText=s.size,c.appendChild(a),c.appendChild(p),c.appendChild(k),I.appendChild(c)}),S.replaceChildren(),n.additives.forEach((l,s)=>{const o=document.createElement("label");o.classList.add("modal__option-container","button-link"),o.title=h?l.discountPrice??l.price:l.price,o.htmlFor=l.name;const c=document.createElement("input");c.type="checkbox",c.id=l.name,c.name="additives",c.value=h?l.discountPrice??l.price:l.price;const a=B.bind(null,n);c.addEventListener("change",a),E.push([c,a]);const u=document.createElement("span");u.classList.add("modal__option-label"),u.innerText=`${s+1}`;const p=document.createElement("span");p.innerText=l.name,o.appendChild(c),o.appendChild(u),o.appendChild(p),S.appendChild(o)}),B(n);const r=V.bind(null,n);A.addEventListener("click",r),L.push([A,r]),b.style.display="block"}catch{z.style.display="flex",document.body.classList.remove("no-scroll"),_.classList.remove("_active"),b.style.display="none"}finally{w.style.display="none"}},B=e=>{let d=Number(e.price);I.querySelectorAll('input[name="size"]').forEach(t=>{t.checked&&(d=Number(t.value),f=t.id)}),S.querySelectorAll('input[name="additives"]').forEach(t=>{t.checked?(d+=Number(t.value),m.includes(t.id)||m.push(t.id)):m=m.filter(i=>i!==t.id)}),j.innerText=`$${d.toFixed(2)}`},D=()=>{x.replaceChildren();for(let e=0;e<g.length;e++)if(g[e].checked){const t=g[e].value,i=T.filter(n=>t===n.category).map(n=>Q(n));i.forEach(n=>x.appendChild(n)),window.screen.width<1440&&(i.length>4?v.classList.add("_active"):v.classList.remove("_active"));break}},V=e=>{const d=localStorage.getItem(C.CART);if(d){const t=JSON.parse(d);t.push({...e,selectedSize:f,selectedAdditives:m}),localStorage.setItem(C.CART,JSON.stringify(t)),P.innerText=`${t.length}`}else localStorage.setItem(C.CART,JSON.stringify([{...e,selectedSize:f,selectedAdditives:m}])),P.innerText="1";h||(W.style.display="flex"),y(null,!1)},X=async()=>{try{(await N(O.PRODUCTS)).forEach(d=>{const t=M.find(i=>i.id===d.id);T.push({...d,...t})}),D(),R.style.display="flex"}catch{F.style.display="flex"}finally{q.style.display="none"}};X();g.forEach(e=>e.addEventListener("change",D));v.addEventListener("click",()=>{document.querySelectorAll(".menu__preview-item").forEach(d=>{d.style.display="block",v.classList.remove("_active")})});document.addEventListener("keydown",e=>{e.key==="Escape"&&y(null,!1)});U.addEventListener("click",y.bind(null,null,!1));G.addEventListener("click",y.bind(null,null,!1));
